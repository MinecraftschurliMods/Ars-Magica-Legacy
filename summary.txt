Implements most of the WIP spellparts, and includes various minor changes and fixes.